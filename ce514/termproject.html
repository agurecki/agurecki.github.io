<html>
<head>
  <title>Great Blue Heron Sighting Predictor</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <!-- Link to external Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
      <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script> 
  <link rel="stylesheet" href="../style.css">  

  <style>
    #forecast-container {
  display: none;
  margin-top: 20px;
  border: 1px solid #dee2e6; /* Light gray border */
  padding: 20px;
  border-radius: 8px;
  background-color: white; /* White background for the forecast area */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

#streamflowChart {
    margin-top: 20px;
    width: 100%; /* Make the chart take full width */
    max-width: 800px; /* Limit the maximum width */
    height: 400px; /* Set a fixed height */
    max-height: 600px; /* Limit the maximum height */
    margin-left: auto; /* Center the chart horizontally */
    margin-right: auto; /* Center the chart horizontally */
}
  </style>
</head>

  
<body>
    <header>
        <h1>Amber Allen</h1>
      <h2>A9 - NWM Forcast Application</h2>
        <p>CE 514 | Winter 2025 | February 20, 2025</p>
    </header>

    <div class="container">
        <section>
  <h1>Great Blue Heron Sighting Forecaster</h1>
  <h2>About the Creator</h2>
          <p>Amber Allen is a Ph.D. student in Civil Engineering at Brigham Young University, specializing in transportation emissions and air quality. 
  She is currently enrolled in CE 514 â€“ Geospatial Software Development, a graduate-level course that explores various tools for creating 
  and analyzing geospatial data. The course integrates coding languages such as HTML, CSS, and JavaScript to enhance technical proficiency
  and effectively communicate geospatial concepts. This website is an application of what has been learned during the first unit of study, 
  including Leaflet, KML, and the National Water Model. </p> <br>

          <h2>About the Data</h2>       
<p>
  The <strong>National Water Model (NWM)</strong> is a high-resolution hydrologic modeling system that provides 
  real-time and forecasted streamflow predictions for over <strong>2.7 million stream reaches</strong> across the United States. 
  Using the <strong>National Hydrography Dataset (NHDPlus)</strong>, the model simulates detailed river networks to support 
  water resource planning and emergency response.
</p>

<p>
  The NWM offers multiple forecast scenarios, including <strong>short-range (up to 18 hours), medium-range (10 days), 
  and long-range (30 days) predictions</strong>, along with retrospective analyses for trend studies. By incorporating 
  real-time observations from <strong>stream gauges, radar, and satellite data</strong>, the model improves accuracy and 
  reliability in monitoring <strong>floods, droughts, and changing hydrologic conditions</strong>.
</p>

<p>
  While the NWM is a valuable tool for <strong>water resource managers, emergency responders, and researchers</strong>, 
  it is essential to recognize that forecasts are subject to <strong>uncertainties due to weather variability, data 
  limitations, and model assumptions</strong>. Users should interpret the data carefully and supplement it with 
  local knowledge and official flood warnings when making critical decisions.
</p>

          </section>
    </div>

      <div class="container">
        <section>
  <h2>Resources</h2>
  <p>Learn more about the NWM:</p>
  <ul>
    <li><a href="https://water.noaa.gov/about/nwm">NOAA NWM Homepage</a></li>
    <li><a href="howitworks.html">How This Web App Works</a></li>
  </ul>
        </section>
      </div>
<div id="map"></div>
    <script>
    // Initialize the map
    var map = L.map('map').setView([42.3601, -71.0589], 9); // Center on the MASS

    // Add a tile layer (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Load KML file (replace with your actual file URL)
    var kmlLayer = omnivore.kml('https://raw.githubusercontent.com/agurecki/agurecki.github.io/refs/heads/main/ce514/watersheds2.kml')
        .on('ready', function() {
            map.fitBounds(kmlLayer.getBounds()); // Fit map to KML bounds

            // Iterate over each feature in the KML layer
            kmlLayer.eachLayer(function(layer) {
                if (layer.feature && layer.feature.properties) {
                    var name = layer.feature.properties.name || "Unknown State";
                    var desc = layer.feature.properties.description || "No description available";
                    
                    // Bind popup with state name and description
                    layer.bindPopup("<b>" + name + "</b><br>" + desc);
                }
            });
        })
        .addTo(map);
          var kmlLayer = omnivore.kml('https://raw.githubusercontent.com/agurecki/agurecki.github.io/refs/heads/main/ce514/Major_Rivers_and_Streams.kml')
        .on('ready', function() {
            map.fitBounds(kmlLayer.getBounds()); // Fit map to KML bounds

            // Iterate over each feature in the KML layer
            kmlLayer.eachLayer(function(layer) {
                if (layer.feature && layer.feature.properties) {
                    var name = layer.feature.properties.name || "Unknown State";
                    var desc = layer.feature.properties.description || "No description available";
                    
                    // Bind popup with state name and description
                    layer.bindPopup("<b>" + name + "</b><br>" + desc);
                }
            });
        })
        .addTo(map);
</script>
      <div class="container">
        <section>
  <h2>Enter Reach ID:</h2>
          <p>Browse the National Water Prediction Service
            website to find the Reach ID of your water system of interest. </p> <br>
<div style="display: flex; justify-content: center; align-items: center; height: 100vh;">
</div>
  <input type="text" id="reachIdInput" placeholder="Enter a Reach ID (e.g., 10274616)">
  <button onclick="getForecast()">Get Forecast</button>
        </section>
      </div>
  
  <div id="forecast-container">
    <table id="timeseries-datatable">
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>Flow value</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <canvas id="streamflowChart"></canvas>
  </div>

  <div id="container">
    <section>
    <h2>How It Works</h2>
    <p>
        The streamflow forecast tool retrieves and displays forecasted water flow data based on a user-provided 
        <strong>Reach ID</strong>. Here's how it works:
    </p>

    <h3>1. User Input</h3>
    <p>
        The user enters a Reach ID into the input field and clicks the "Get Forecast" button. If no ID is entered, 
        an alert prompts the user to provide one.
    </p>

    <h3>2. Fetching Forecast Data</h3>
    <p>
        The tool sends a request to the <a href="https://api.water.noaa.gov/nwps/v1" target="_blank">NOAA NWPS API</a> 
        using the entered Reach ID. If the API responds successfully, the streamflow forecast data is retrieved.
        If no data is available, an error message is displayed.
    </p>

    <h3>3. Displaying the Data</h3>
    <p>
        The forecast section appears, and the retrieved data is processed into two key components:
    </p>
    <ul>
        <li><strong>A Table:</strong> Displays time-stamped streamflow values.</li>
        <li><strong>A Chart:</strong> A visually appealing line graph showing streamflow trends over time.</li>
    </ul>

    <h3>4. Chart Features</h3>
    <p>
        The chart uses <a href="https://www.chartjs.org/" target="_blank">Chart.js</a> and includes:
    </p>
    <ul>
        <li>Smooth curved lines for better readability.</li>
        <li>A blue gradient background representing water flow.</li>
        <li>Interactive hover effects for precise data points.</li>
        <li>Custom-styled axis labels and tooltips.</li>
    </ul>

    <h3>5. Error Handling</h3>
    <p>
        If something goes wrong (e.g., an invalid Reach ID or network issues), the tool:
    </p>
    <ul>
        <li>Displays an error message.</li>
        <li>Clears any previously displayed data to prevent confusion.</li>
    </ul>

    <h3>Final Result</h3>
    <p>
        This tool automates the process of retrieving, formatting, and presenting streamflow forecast data, 
        making it easy to analyze water flow trends in real time! ðŸš€
    </p>
  </div>

<script>
  document.querySelectorAll('a').forEach(link => {
    link.setAttribute('target', '_blank');
    link.setAttribute('rel', 'noopener noreferrer');
  });
</script>
  <script src="reachid.js"></script> </body>
</html>
